---
title: Webhooks Setup
description: Receive real-time payment notifications
---

Webhooks push real-time notifications to your server when payment events occur.

## How It Works

```
Wallet API                              Your Server
    │                                       │
    │  Payment detected                     │
    │  ─────────────────────────────────▶  │
    │  POST /your-webhook-endpoint          │
    │                                       │
    │         200 OK                        │
    │  ◀─────────────────────────────────  │
    │                                       │
```

---

## Configure Webhook

<span class="http-method post">POST</span>
<span class="endpoint-path">/webhooks</span>

```bash
curl -X POST https://api.yourdomain.com/api/v1/webhooks \
  -H "X-API-Key: sk_live_abc123..." \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://your-casino.com/api/wallet-webhook",
    "events": ["payment.detected", "payment.confirmed"]
  }'
```

---

## Response (201 Created)

```json
{
  "id": 1,
  "url": "https://your-casino.com/api/wallet-webhook",
  "events": ["payment.detected", "payment.confirmed"],
  "is_active": true,
  "created_at": "2024-01-20T10:00:00Z",
  "secret": "whsec_abc123def456..."
}
```

:::note
The `secret` is only returned when creating the webhook. Store it securely!
:::

---

## Configuration Options

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `url` | string | Yes | Your webhook endpoint URL (HTTPS recommended) |
| `secret` | string | No | Custom signing secret (auto-generated if not provided) |
| `events` | array | Yes | Events to subscribe to |

---

## Event Types

| Event | Description |
|-------|-------------|
| `payment.detected` | New payment seen (0 confirmations) |
| `payment.confirming` | Payment has 1+ confirmations |
| `payment.confirmed` | Required confirmations reached |
| `payment.failed` | Payment dropped or failed |

---

## Webhook Headers

Each webhook request includes:

| Header | Description |
|--------|-------------|
| `X-Wallet-Signature` | HMAC-SHA256 signature |
| `X-Wallet-Timestamp` | Unix timestamp of the request |
| `X-Wallet-Event` | Event type |
| `Content-Type` | `application/json` |

---

## Webhook Payload

All webhooks are `POST` requests with JSON body:

```json
{
  "event": "payment.confirmed",
  "timestamp": "2024-01-20T14:45:00Z",
  "data": {
    "payment_id": "pay_a1b2c3d4e5f6",
    "chain": "eth",
    "tx_hash": "0x8a5f3e2b1c4d5e6f...",
    "address": "0x742d35Cc6634C0532925a3b844Bc9e7595f8bDe7",
    "external_id": "user_123456",
    "amount": "0.5",
    "amount_raw": "500000000000000000",
    "token": "ETH",
    "status": "confirmed",
    "confirmations": 12,
    "required_confirmations": 12,
    "block_number": 19234567,
    "from_address": "0x9876543210abcdef...",
    "detected_at": "2024-01-20T14:30:00Z",
    "confirmed_at": "2024-01-20T14:45:00Z",
    "metadata": null
  }
}
```

---

## Get Current Webhook

<span class="http-method get">GET</span>
<span class="endpoint-path">/webhooks</span>

```bash
curl https://api.yourdomain.com/api/v1/webhooks \
  -H "X-API-Key: sk_live_abc123..."
```

Returns the active webhook configuration (without the secret).

---

## Delete Webhook

<span class="http-method delete">DELETE</span>
<span class="endpoint-path">/webhooks</span>

```bash
curl -X DELETE https://api.yourdomain.com/api/v1/webhooks \
  -H "X-API-Key: sk_live_abc123..."
```

Returns `204 No Content` on success.

---

## Response Requirements

Your endpoint must:

1. Return `2xx` status code within 30 seconds
2. Return quickly (process async if needed)

```python
@app.post("/api/wallet-webhook")
async def webhook(request: Request):
    payload = await request.json()

    # Verify signature first!
    verify_signature(request)

    # Queue for async processing
    await queue.push(payload)

    # Return immediately
    return {"received": True}
```
